<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>gis Database</title>
        <!-- Tell the browser to be responsive to screen width -->
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
        <link rel="icon" type="image/png" sizes="16x16" href="favicon.png">
        <!-- Bootstrap 3.3.5 -->
        <link rel="stylesheet" href="bower/admin-lte/bootstrap/css/bootstrap.min.css">
        <!-- Font Awesome -->
        <link rel="stylesheet" href="bower/font-awesome/css/font-awesome.min.css">
        <!-- Ionicons -->
        <link rel="stylesheet" href="bower/ionicons/css/ionicons.min.css">
        <!-- DataTables -->
        <link rel="stylesheet" href="bower/datatables.net-bs/css/dataTables.bootstrap.min.css">
        <link rel="stylesheet" href="bower/datatables.net-buttons-bs/css/buttons.bootstrap.min.css">
        <!-- Code Mirror -->
        <link rel="stylesheet" href="bower/codemirror/codemirror.css">
        <!-- Fonts -->
        <link href='fonts/indieflower/indie-flower.css' rel='stylesheet' type='text/css'>
        <link href='fonts/source-sans-pro/source-sans-pro.css' rel='stylesheet' type='text/css'>

        <!-- Theme style -->
        <link rel="stylesheet" href="bower/admin-lte/dist/css/AdminLTE.min.css">
        <!-- Salvattore -->
        <link rel="stylesheet" href="bower/salvattore/salvattore.css">
        <!-- AdminLTE Skins. Choose a skin from the css/skins
           folder instead of downloading all of them to reduce the load. -->
        <link rel="stylesheet" href="bower/admin-lte/dist/css/skins/_all-skins.min.css">
        <!-- SchemaSpy -->
        <link rel="stylesheet" href="schemaSpy.css">

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="bower/html5shiv/html5shiv.min.js"></script>
        <script src="bower/respond/respond.min.js"></script>
        <![endif]-->
    </head>
    <!-- ADD THE CLASS layout-top-nav TO REMOVE THE SIDEBAR. -->
    <body class="hold-transition skin-blue layout-top-nav">
        <div class="wrapper">
            <header class="main-header">
                <nav class="navbar navbar-static-top">
                    <div class="container">
                        <div class="navbar-header">
                            <a href="index.html" class="navbar-brand"><b>gis</b> Database</a>
                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse"><i class="fa fa-bars"></i></button>
                        </div>

                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                            <ul class="nav navbar-nav">
                                <li><a href="index.html">Tables <span class="sr-only">(current)</span></a></li>
                                <li><a href="columns.html" title="All of the columns in the schema">Columns</a></li>
                                <li><a href="constraints.html" title="Useful for diagnosing error messages that just give constraint name or number">Constraints</a></li>
                                <li><a href="relationships.html" title="Diagram of table relationships">Relationships</a></li>
                                <li><a href="orphans.html" title="View of tables with neither parents nor children">Orphan&nbsp;Tables</a></li>
                                <li><a href="anomalies.html" title="Things that might not be quite right">Anomalies</a></li>
                                <li><a href="routines.html" title="Procedures and functions">Routines</a></li>
                            </ul>
                        </div>
                        <!-- /.navbar-collapse -->
                        <!-- Navbar Right Menu -->
                    </div>
                    <!-- /.container-fluid -->
                </nav>
            </header>
            <!-- Main content -->
            <!-- Full Width Column -->
            <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>Routines</h1>
                </section>
                <!-- Main content -->
                <section class="content">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <i class="fa fa-file-code-o" aria-hidden="true"></i>
                            <h3 class="box-title">Routines</h3>
                        </div>
                        <div class="box-body">
                            <table id="routine_table" class="table table-bordered table-striped dataTable" role="grid">
                                <thead align='left'>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th>Language</th>
                                        <th>Deterministic</th>
                                        <th>Return Type</th>
                                        <th>Security Restriction</th>
                                        <th title='Comments' class="toggle"><span>Comments</span></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><a href="routines/rollback_event.html">rollback_event</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>void</td>
                                        <td>INVOKER</td>
                                        <td><p>Rollback a logged event and returns to previous row data</p>
<p>Arguments:<br />
pevent_id:  The event_id of the event in lizsync.logged_actions to rollback</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/compare_tables.html">compare_tables</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF record</td>
                                        <td>INVOKER</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/get_central_audit_logs.html">get_central_audit_logs</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF record</td>
                                        <td>INVOKER</td>
                                        <td><p>Get all the logs from the central database: modifications do not come from the clone, have not yet been replayed by the clone, are dated after the last synchronisation, have an event id higher than the last sync maximum event id, and concern the synchronised tables for this clone. Parameters: uid column name and excluded columns</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/audit_view.html">audit_view</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>void</td>
                                        <td>INVOKER</td>
                                        <td><p>ADD auditing support TO a VIEW.</p>
<p>Arguments:<br />
target_view:      TABLE name, schema qualified IF NOT ON search_path<br />
audit_query_text: Record the text of the client query that triggered the audit event?<br />
ignored_cols:     COLUMNS TO exclude FROM UPDATE diffs, IGNORE updates that CHANGE only ignored cols.<br />
uid_cols:         COLUMNS to use to uniquely identify a row from the view (in order to replay UPDATE and DELETE)</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/analyse_audit_logs.html">analyse_audit_logs</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF record</td>
                                        <td>INVOKER</td>
                                        <td><p>Get audit logs from the central database and the clone since the last synchronization. Compare the logs to find and resolved UPDATE conflicts (same table, feature, column): last modified object wins. This function store the resolved conflicts into the table lizsync.conflicts in the central database. Returns central server event ids, minimum event id, maximum event id, maximum action timestamp.</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/create_temporary_table.html">create_temporary_table</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>boolean</td>
                                        <td>INVOKER</td>
                                        <td><p>Create temporary table used during database bidirectionnal synchronization. Parameters: temporary table name, and table type (audit or conflit)</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/if_modified_func.html">if_modified_func</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>trigger</td>
                                        <td>DEFINER</td>
                                        <td><p>Track changes to a table at the statement and/or row level.</p>
<p>Optional parameters to trigger in CREATE TRIGGER call:</p>
<p>param 0: boolean, whether to log the query text. Default &lsquo;t&rsquo;.</p>
<p>param 1: text[], columns to ignore in updates. Default [].</p>
<pre><code>     Updates to ignored cols are omitted from changed_fields.

     Updates with only ignored cols changed are not inserted
     into the audit log.

     Almost all the processing work is still done for updates
     that ignored. If you need to save the load, you need to use
     WHEN clause on the trigger instead.

     No warning or error is issued if ignored_cols contains columns
     that do not exist in the target table. This lets you specify
     a standard set of ignored columns.
</code></pre>
<p>There is no parameter to disable logging of values. Add this trigger as<br />
a &lsquo;FOR EACH STATEMENT&rsquo; rather than &lsquo;FOR EACH ROW&rsquo; trigger if you do not<br />
want to log row values.</p>
<p>Note that the user name logged is the login role for the session. The audit trigger<br />
cannot obtain the active role because it is reset by the SECURITY DEFINER invocation<br />
of the audit trigger its self.</p>
<p>[]: ./null<br />
[]: ./null</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/add_uid_columns.html">add_uid_columns</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>boolean</td>
                                        <td>INVOKER</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/get_event_sql.html">get_event_sql</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>text</td>
                                        <td>INVOKER</td>
                                        <td><p>Get the SQL to use for replay from a audit log event</p>
<p>Arguments:<br />
pevent_id:  The event_id of the event in lizsync.logged_actions to replay<br />
puid_column: The name of the column with unique uuid values</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/create_central_server_fdw.html">create_central_server_fdw</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>boolean</td>
                                        <td>INVOKER</td>
                                        <td><p>Create foreign server, needed central_lizsync schema, and import all central database tables as foreign tables. This will allow the clone to connect to the central databse</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/get_clone_audit_logs.html">get_clone_audit_logs</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF record</td>
                                        <td>INVOKER</td>
                                        <td><p>Get all the modifications made in the clone. Parameters: uid column name and excluded columns</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/synchronize.html">synchronize</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF record</td>
                                        <td>INVOKER</td>
                                        <td><p>Run the bi-directionnal database synchronization between the clone and the central server</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/replay_clone_logs_to_central.html">replay_clone_logs_to_central</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF integer</td>
                                        <td>INVOKER</td>
                                        <td><p>Replay all logs from the clone to the central database. It returns the number of actions replayed. After this, the clone audit logs are truncated.</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/replay_event.html">replay_event</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>void</td>
                                        <td>INVOKER</td>
                                        <td><p>Replay a logged event.</p>
<p>Arguments:<br />
pevent_id:  The event_id of the event in lizsync.logged_actions to replay</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/store_conflicts.html">store_conflicts</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF integer</td>
                                        <td>INVOKER</td>
                                        <td><p>Store resolved conflicts in the central database lizsync.conflicts table.</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/audit_table.html">audit_table</a></td>
                                        <td>FUNCTION</td>
                                        <td>SQL</td>
                                        <td>false</td>
                                        <td>void</td>
                                        <td>INVOKER</td>
                                        <td><p>Add auditing support to a table.</p>
<p>Arguments:<br />
target_table:     Table name, schema qualified if not on search_path<br />
audit_rows:       Record each row change, or only audit at a statement level<br />
audit_query_text: Record the text of the client query that triggered the audit event?<br />
ignored_cols:     Columns to exclude from update diffs, ignore updates that change only ignored cols.</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/replay_central_logs_to_clone.html">replay_central_logs_to_clone</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF integer</td>
                                        <td>INVOKER</td>
                                        <td><p>Replay the central logs in the clone database, then modifiy the corresponding audit logs in the central server to update the sync_data column. A new item is also created in the central server lizsync.history table. When running the log queries, we disable triggers in the clone to avoid adding more rows to the local audit logged_actions table</p></td>
                                    </tr>
                                    <tr>
                                        <td><a href="routines/import_central_server_schemas.html">import_central_server_schemas</a></td>
                                        <td>FUNCTION</td>
                                        <td>PLPGSQL</td>
                                        <td>false</td>
                                        <td>SETOF ARRAY</td>
                                        <td>INVOKER</td>
                                        <td><p>Import synchronised schemas from the central database foreign server into central_XXX local schemas to the clone database. This allow to edit data of the central database from the clone.</p></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                <script>
                    var config = {
                        pagination: true
                    }
                </script>
            </div>
            <!-- /.content-wrapper -->
            <footer class="main-footer">
                <div>
                    <div class="pull-right hidden-xs">
                        <a href="https://github.com/schemaspy/schemaspy" title="GitHub for SchemaSpy"><i class="fa fa-github-square fa-2x"></i></a>
                        <a href="http://stackoverflow.com/questions/tagged/schemaspy" title="StackOverflow for SchemaSpy"><i class="fa fa-stack-overflow fa-2x"></i></a>
                    </div>
                    <strong>Generated by <a href="http://schemaspy.org/" class="logo-text"><i class="fa fa-database"></i> SchemaSpy 6.1.0</a></strong>
                </div>
                <!-- /.container -->
            </footer>
        </div>
        <!-- ./wrapper -->

        <!-- jQuery 2.2.3 -->
        <script src="bower/admin-lte/plugins/jQuery/jquery-2.2.3.min.js"></script>
        <script src="bower/admin-lte/plugins/jQueryUI/jquery-ui.min.js"></script>
        <!-- Bootstrap 3.3.5 -->
        <script src="bower/admin-lte/bootstrap/js/bootstrap.min.js"></script>
        <!-- DataTables -->
        <script src="bower/datatables.net/jquery.dataTables.min.js"></script>
        <script src="bower/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
        <script src="bower/datatables.net-buttons/dataTables.buttons.min.js"></script>
        <script src="bower/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
        <script src="bower/datatables.net-buttons/buttons.html5.min.js"></script>
        <script src="bower/datatables.net-buttons/buttons.print.min.js"></script>
        <script src="bower/datatables.net-buttons/buttons.colVis.min.js"></script>
        <!-- SheetJS -->
        <script src="bower/js-xlsx/xlsx.full.min.js"></script>
        <!-- pdfmake -->
        <script src="bower/pdfmake/pdfmake.min.js"></script>
        <script src="bower/pdfmake/vfs_fonts.js"></script>
        <!-- SlimScroll -->
        <script src="bower/admin-lte/plugins/slimScroll/jquery.slimscroll.min.js"></script>
        <!-- FastClick -->
        <script src="bower/admin-lte/plugins/fastclick/fastclick.js"></script>
        <!-- Salvattore -->
        <script src="bower/salvattore/salvattore.min.js"></script>
        <!-- AnchorJS -->
        <script src="bower/anchor-js/anchor.min.js"></script>
        <!-- CodeMirror -->
        <script src="bower/codemirror/codemirror.js"></script>
        <script src="bower/codemirror/sql.js"></script>
        <!-- AdminLTE App -->
        <script src="bower/admin-lte/dist/js/app.min.js"></script>
        <script src="routines.js"></script>
        <script src="schemaSpy.js"></script>
    </body>
</html>